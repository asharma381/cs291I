from typing import List
from flair.data import Sentence
from flair.models import SequenceTagger

def do_get_nouns(captions: List[str]) -> List[str]:
    tagger = SequenceTagger.load("flair/pos-english")
    sentence = Sentence(captions)
    tagger.predict(sentence)

    nouns = set()
    for i, word in enumerate(sentence.annotation_layers["pos"]):
        if word._value in {"NN", "NNS"}:
            nouns.add(captions[i])
    return list(nouns)

if __name__ == "__main__":
    captions = ['a', 'table', 'with', 'a', 'white', 'table', 'cloth', 'and', 'a', 'cup', 'of', 'coffee', 'a', 'white', 'chair', 'with', 'a', 'metal', 'seat', 'cover', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'close', 'up', 'of', 'a', 'pair', 'of', 'scissors', 'on', 'a', 'table', 'a', 'picture', 'of', 'a', 'dark', 'room', 'with', 'a', 'dark', 'background', 'a', 'black', 'table', 'with', 'a', 'black', 'and', 'brown', 'table', 'cloth', 'a', 'picture', 'of', 'a', 'piece', 'of', 'wood', 'with', 'a', 'pair', 'of', 'scissors', 'a', 'white', 'chair', 'with', 'a', 'metal', 'seat', 'cover', 'a', 'laptop', 'computer', 'sitting', 'on', 'a', 'desk', 'next', 'to', 'a', 'keyboard', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'wooden', 'table', 'a', 'large', 'metal', 'object', 'is', 'shown', 'in', 'a', 'dark', 'room', 'a', 'white', 'plate', 'with', 'a', 'pair', 'of', 'scissors', 'on', 'it', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'two', 'chairs', 'with', 'a', 'pair', 'of', 'scissors', 'on', 'them', 'a', 'close', 'up', 'of', 'a', 'metal', 'plate', 'with', 'a', 'metal', 'object', 'a', 'large', 'truck', 'driving', 'down', 'a', 'street', 'next', 'to', 'a', 'forest', 'a', 'table', 'with', 'a', 'laptop', 'and', 'a', 'tablet', 'on', 'it', 'a', 'metal', 'sink', 'with', 'a', 'metal', 'faucet', 'and', 'a', 'metal', 'faucet', 'a', 'white', 'box', 'with', 'a', 'white', 'and', 'red', 'envelope', 'a', 'close', 'up', 'of', 'a', 'round', 'hole', 'in', 'a', 'dark', 'room', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'wooden', 'desk', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'picture', 'of', 'a', 'laptop', 'on', 'a', 'desk', 'a', 'close', 'up', 'of', 'a', 'metal', 'scissors', 'sticking', 'out', 'of', 'a', 'metal', 'holder', 'a', 'black', 'and', 'white', 'square', 'shaped', 'toothbrush', 'holder', 'a', 'close', 'up', 'of', 'a', 'backpack', 'and', 'a', 'backpack', 'a', 'close', 'up', 'of', 'a', 'metal', 'object', 'with', 'a', 'metal', 'ring', 'a', 'black', 'cat', 'laying', 'on', 'top', 'of', 'a', 'floor', 'a', 'black', 'object', 'sticking', 'out', 'of', 'a', 'metal', 'object', 'a', 'picture', 'of', 'a', 'faded', 'photo', 'of', 'a', 'tree', 'a', 'black', 'cat', 'is', 'laying', 'on', 'a', 'carpet', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'wooden', 'table', 'a', 'backpack', 'and', 'a', 'backpack', 'on', 'a', 'table', 'a', 'table', 'with', 'three', 'chairs', 'and', 'a', 'laptop', 'on', 'it', 'a', 'view', 'of', 'a', 'window', 'with', 'a', 'blurry', 'background', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'white', 'chair', 'with', 'a', 'metal', 'chair', 'and', 'a', 'white', 'chair', 'a', 'laptop', 'computer', 'sitting', 'on', 'a', 'desk', 'with', 'a', 'mouse', 'a', 'metal', 'chair', 'with', 'a', 'metal', 'seat', 'cover', 'a', 'white', 'chair', 'with', 'a', 'metal', 'back', 'seat', 'and', 'a', 'metal', 'back', 'seat', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'desk', 'a', 'view', 'of', 'a', 'window', 'with', 'a', 'train', 'on', 'it', 'a', 'small', 'white', 'blanket', 'on', 'top', 'of', 'a', 'bed', 'a', 'laptop', 'computer', 'sitting', 'on', 'top', 'of', 'a', 'table', 'a', 'picture', 'of', 'a', 'picture', 'of', 'a', 'building', 'with', 'a', 'tree', 'in', 'the', 'background', 'a', 'close', 'up', 'of', 'a', 'black', 'and', 'white', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped', 'striped']
    print(do_get_nouns(captions))